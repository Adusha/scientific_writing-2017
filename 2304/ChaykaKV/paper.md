# Анализ средств планирования траекторий движений произвольного количества роботов

## Аннотация
В настоящее время автономные роботы получают широкое применение и очень остро стоит проблема автоматического планирования траектории их передвижения, будь то робот-манипулятор или колесный робот. Задача приобретает несколько другое направление, если говорить об ее применимости к реальным роботам, а не моделям и в случаях когда роботов, чьи траектории движения требуется построить, становится больше одного. В данной работе проведен анализ средств, позволяющих выполнить планирование траекторий нескольких роботов и рассмотрена возможность их интеграции с ROS (Robot Operating System) с целью использования на реальном роботе. Дальнейшим направлением является построение демо-модели планирования траекторий нескольких роботов.

## Введение

## Сравнение аналогов
### MoveIt!
Открытый фреймворк для управления роботами в области планирования движений, манипуляцией с предметами, с учетом физических сил, на них действующих. Этот фреймворк активно используется для управления большим списком роботов, среди которых PR2, HOLLIE, AR10 Robotic Hand и другие. MoveIt! тесно интегрирован и разрабатывается совмесно с ROS. Фактически, в MoveIt нет поддержки планирования траекторий группы роботов, но ее можно сымитировать, построив единую модель на базе нескольких роботов, приняв их за компоненты единой модели.

### TMKit (Task-Motion Planning Framework)
Фреймворк с открытым кодом для планирований движений. Довольно простой с точки зрения интерфейса использования. Разрабатывается как проект Kavraki Lab - части исследовательского института Техаса. На данный момент имеет статус alpha1 и имеет довольно неполную документацию.

### OMPL (Open Motion Planning Library)
Библиотека для планирования движений, имеющая реализации абстрактных планировщиков; не ориентирована на какую-то конкретную область. Имеет подробную документацию. Полностью поддерживается и используется во фреймворке MoveIt!, используется, но поддерживается частично во фреймфорке TMKit.

### Simox
Набор инструментов для C++ содержащих три библиотеки для 3D моделирования роботизированных систем, планирования на основе выборки и планирования захвата. В официальном репозитории имеется несколько примеров и небольшое описание компонентов, однако для начала работы с нуля этого может быть недостаточно. Какую-либо дополнительную информацию о библиотеке Saba, отвечающей за планирование в Simox, найти трудно.

## Критерии сравнения аналогов
### Интеграция с ROS
Важным критерием является интеграция средства планирования с Robot Operating System. Это позволит с минимальными усилиями внедрить планировщик в уже существующую архитектуру.

### Простота использования и конфигурации
Планирование движений - наукоемкая задача, поэтому чем меньший порог вхождения может обеспечить то или иное средство планирования, тем предпочтительнее оно для использования. Будем считать, что средство требует высокий порог вхождения, если от пользователя требуется знание алгоритмов, используемых планировщиком и/или с уравнениями движений/физическими свойствами объектов.

### Поддержка и документация
Важным критерием при выборе используемого инструмента является наличие подробной и полной документации, а также возможность поддержки.

## Таблица сравнения по критериям

Аналог\Критерий|Интеграция с ROS|Простота|Поддержка|Планирование траекторий группы
-|-|-|-|-
MoveIt!|+|+/-|+|-/+
TMKit|-|+|-|-
OMPL|-|-|+|+
Simox|-|+/-|-/+|+ 

## Выводы по итогам сравнения
По результатам сравнения, Фреймворк MoveIt! имеет очевидное преимущество перед другими аналогами. Он имеет подробную документацию, что значительно упрощает работу с ним, использует все возможности OMPL, при этом является ориентированным на использование в роботах. Также, весомым преимуществом является его полная интеграция с ROS.

## Источники

1. http://moveit.ros.org
2. http://tmkit.kavrakilab.org
3. http://ompl.kavrakilab.org/
4. https://gitlab.com/Simox/simox


## Выбор метода решения

В результате обзора аналогов, было определено, что существует ряд средств для планирования движения роботов, в том числе мобильных и большинство этих средств имеют поддержку планирования движения группы роботов. Некоторые - неявным образом. 

На основании этого, требуется:
- Изучить подходы, используемые в этих средствах для планирования траектории одного робота.
- Исследовать подход, используемый для планирования траекторий группы роботов (в случае, если он отличается, от ситуации с одним роботом)
- Определить формат представления модели робота для каждого из средств
- Выяснить способы представления модели нескольких роботов, возможно ли это сделать явно (в противном случае - как это отражается на модели робота)
- Выяснить формат исходных данных для средства планирования, способы их автоматической генерации (на основании известного окружения, включая другие роботы, начальных координат и координат назначения каждого робота)
- Определить как подходы к генерации будут отличаться при невозможности явного планирования траекторий группы роботов.
- Рассмотреть способы интеграции данных решений в проект на ROS, что для этого потребуется, какие возникают при этом ограничения
- Сравнить выбранные средства и способы планирования движения групп роботов, которые они реализуют. На основании чего сделать выводы о применимости данных решений по отношению к мобильным роботам в проекте Duckietown.

## Описание метода решения

Детально рассмотрим средства планирования для составления описания каждого из них по следующим параметрам:
* Каким образом реализован механизм планирования
* Поддерживается ли планирование совместных траекторий нескольких роботов
* Как, в каком формате задается описание робота
* Что требуется для использования средства в ROS

### MoveIt!
Для планирования траектории одного робота MoveIt! использует библиотеку OMPL[1], являясь фактически большой оберткой этой библиотеки, но, в отличие от самой OMPL, робото ориентированной. 

Что касается поддержки планирования совместных траекторий нескольких роботов, то явным образом она в MoveIt! отсутствует, несмотря на поддержку в OMPL. Попытка внедрения этой возможности в фреймворк связана с большими его изменениями и на данный момент она не планируется. Однако, это ограничение возможно обойти.

Описание робота для MoveIt задается в URDF (Unified Robot Description Format)[2], на основании которого самим фреймворком генерируется SRDF (Semantic Robot Description Format)[3] и еще некоторые требуемые ему данные. Для взаимодействия с планировщиком MoveIt предоставляет интерфейс для программ на языках C++ или Python, с помощью которого можно задавать цели для передвижения, определять взаимодействие с объектами и другое.

Несмотря на то, что MoveIt явным образом не поддерживает несколько роботов, он поддерживает планирование движений роботов-манипуляторов с произвольным количеством "конечностей" с учетом возможных коллизий. Таким образом, возможно представить несколько роботов как несвязанные между собой компоненты некоего абстрактного робота, что позволит обойти ограничение на совместное планирование траекторий. Для этого в URDF описании абстрактного робота требуется задать описание каждого фактического робота, в том числе с учетом взаимного расположения роботов в пространстве.

MoveIt имеет интеграцию с ROS и  не требует дополнительных усилий для того, что бы наладить взаимодействие.

## TMKit (Task-Motion Planning Framework)
Планировщик, который помимо собственного алгоритма тоже использует библиотеку OMPL.

Поддержки планирования совместных траекторий нескольких роботов в этом фреймворке нет

Описание робота может быть задано либо в URDF формате либо в формате описания сцены, предоставляемой библиотекой amino, используемой в TMKit. Для этого фреймворка цели задаются в формате Probabilistic Planning Domain Definition Language (PPDDL) и он предоставляет средства генерации таких файлов.

Какой-либо возможности интеграци с ROS, кроме возможности указать ros-пакет с URDF описанием робота, нет.

## OMPL
Библиотека, которая предоставляет абстрактную реализацию алгоритмов планирования - без ориентации на определенные роботы, устройства. Библиотека также сама не предоставляет какие-либо средства обнаружения коллизий или описания окружения.

Библиотека позволяет выполнять планирование совместных траекторий нескольких роботов

Окружение и описание робота задаются в формате collada

Об интеграции в ROS как таковой, говорить не имеет смысла, по той причине, что сама библиотека не является готовым к использованию фреймворком, но может являться его основой с точки зрения алгоритмов планирования

## Simox
С++ платформа содержащая библиотеки для 3D симуляции и планирования

Библиотека позволяет выполнять планирование совместных траекторий нескольких роботов

Описание робота задается в виде XML, структура которого определена конкретно Simox. Этот формат представления отличается от  URDF. Описание для каждого робота робота задается в отдельном файле. Фактически, за представление робота и окружения отвечает библиотека VirtualRobot, которая предоставляет свое средство планирования Saba[4]. 

Платформа сама по себе не имеет средства интеграции с ROS

## Источники
[1] http://ompl.kavrakilab.org/

[2] http://wiki.ros.org/urdf

[3] http://wiki.ros.org/srdf

[4] https://gitlab.com/Simox/simox/wikis/Saba

https://groups.google.com/forum/#!forum/moveit-users

http://tmkit.kavrakilab.org/usergroup0.html

http://ompl.kavrakilab.org/OMPL_Primer.pdf

https://gitlab.com/Simox/simox/wikis/home

## Заключение
В статье представлено ставнительное исследование фреймворков для планирования траекторий движения роботов. Выделены и обоснованы критерии сравнения аналогов, 

Были исследованы следующие средства: MoveIt!, TMKit, OMPL, Simox с целью сравнения используемых в них подходов к реализации самого механизма планирования, формата описания робота и его окружения, а также возможности интеграции с ROS. Важным критерием также было выяснение поддержки совместного планирования движения группы роботов. 

По результатам исследования, было выяснено, что планирование траекторий группы роботов явным образом поддерживается только в библиотеке OMPL и в Simox. При этом, использование OMPL напрямую крайне затруднительно ввиду того, что это абстрактная библиотека и она не является робото ориентированной. Именно поэтому предпочтительно рассматривать средства, которые ее используют. TMKit поддержку планирование траекторий группы не предоставляет вообще. MoveIt! явным образом тоже не имеет такой возможности, но это ограничение можно попытаться обойти. Также, на фоне Simox, выбор в пользу MoveIt! можно считать более предпочтительным ввиду его полной интеграции с ROS.

Дальнейшим направлением исследования является более подробное исследование возможностей планирования траекторий нескольких роботов с MoveIt! в ROS и построение полноценной демо-модели.

## Список литературы
