# Разработка web-приложения для создания 3D видеороликов 

## Аннотация

Данная статья посвящена проблеме сложности создания 3D видеороликов с точки зрения потребителя. В статье рассмотрены основные существующие варианты создания видеороликов, выявлены их основные достоинства и недостатки и на основе исследования сделаны выводы, что для пользователя важны следующие характеристики системы: прозрачность процесса создания видеоролика, скорость рендеринга и иллюстрация получаемого результата в «реальном времени».  Разработано решение, позволяющее пользователю самостоятельно создавать видеоролики без обращения к посреднику на основе дополняемой библиотеки шаблонов.

## Введение
Среди проблем, связанных с созданием видеороликов, особо выделяется вопрос о создание 3D видеороликов, стоимость и затраченное время на создание которых обратно пропорциональны, низкая стоимость влечет за собой увеличение времени и наоборот. 
Создание 3D видеороликов в хорошем качестве требует больших ресурсных, вычислительных и временных затрат, необходимо найти способ сокращения временных затрат на получение представления общего вида ролика без его полного рендеринга. Скорость получения результата и стоимость являются ключевыми факторами в выборе среди аналогичных решений получения 3D роликов с целью использования в рекламе.
Объектом исследования является процесс создания 3D роликов на примере видео роликов для рекламы книг, предметом - временные затраты получения превью ролика перед его окончательным рендерингом в высоком разрешении.
Цель данного исследования - сокращение времени ожидания перед просмотром превью ролика с возможностью внесения правок (замена текстур, аудио и т.д.).

Поставленные задачи:
* Сравнение с существующими аналогами создания видеороликов книг.
* Изучение популярных сценариев роликов.
* Изучение потребности в инструментах, необходимых для создания данных видеороликов.

## Обзор предметной области
Для решения задачи создания 3D видеороликов можно использовать различные подходы и методы. В данном разделе приведены основные варианты с точки зрения заказчика\потребителя.

#### Обращение к 3D дизайнеру
В идеальном мире, профессиональный дизайнер изготавливает видеоролик быстро и в соответствии со всеми требованиями заказчика. В реальном мире задача осложняется поиском идеального исполнителя.

#### Инструмент создания презентаций
Существует множество бесплатных инструментов для создания презентаций от Mircosoft PowerPoint до независимых open source приложений, например, prezi.com, booktrailersforreaders.com. Однако в перечисленных инструментах отсутствует поддержка создания 3D.

#### Сделать самому в 3D редакторе
Существуют бесплатные 3D редакторы, в которых каждый человек может самостоятельно смоделировать и получить конечный видеоряд. Необходимо иметь навыки работы в сфере 3D моделирования.

### Критерии сравнения аналогов

#### Соответствие требованиям
Критерий оценивает точность соответствия полученного результата изначальным требованиям к видеоролику.

#### Стоимость
Главным критерием для получения какой-либо услуги всегда является стоимость, чем стоимость ниже – тем привлекательнее выглядит предложение на фоне других.

#### Скорость
Скорость выполнения поставленной задачи.

#### Удобство
Под критерием удобства подразумевается соотношение стоимости, качества и скорости.

### Таблица сравнения по критериям
Таблица 1 - Сравнение аналогов

Критерий\Аналог | Дизайнер | Презентация| Самостоятельно
------------ | ------------- | ------------- |------------- 
Соответствие ТЗ |+| -|+
Стоимость | Высокая | Низкая/Бесплатно |Бесплатно
Скорость | Высокая | Низкая | Очень низкая
Удобство | Среднее | Среднее | Среднее 

В таблице 1 приведено сравнение аналогов по описанным выше критериям

В соответствии с приведенными выше аналогами можно сделать вывод, что существует ниша, которую можно занять приложением, предоставляющим необходимые инструменты для реализации поставленных задач с минимальной стоимостью, высокой скоростью и удобством работы.

## Выбор метода решения

В результате обзора методов создания 3D видеороликов была показана низкая эффективность представленных методов с точки зрения соотношения скорости, стоимости и качества полученного результата.

Поэтому, цель работы — разработка программного решения, которое может конкурировать на рынке и требовало минимальных затрат времени пользователя.

При этом решение должно обладать следующими свойствами:
* интерфейс должен воплощать концепцию material design [1,2]. Для пользователя должно быть понятно, что нужно сделать для редактирования того или иного фрагмента в ролике.
* Расширяемый набор шаблонов с возможностью параметризации. Для одного и того же шаблона необходима возможность редактирования не только текстур, но и объектов внутри него по заданным свойствам.
* Широкий набор инструментов редактирования. 
* Быстрое получения превью ролика. Возможность показа пререндера ролика «на лету», для большего удобства работы пользователя и сохранения заинтересованности [3,4].
* Высокая скорость получения конечного результата. Рендеринг должен осуществляться не на компьютере пользователя, для снижения нагрузки [3].  
* Видимый прогресс создания. Информирование пользователя о расчетном времени создания и о готовности ролика.

## Описание метода решения

В результате работы на решением, был разработан программный продукт, который представляет собой Web-приложение для создание рекламных видеороликов презентаций книг, общий вид представлен на рисунке 1. 

![Главная страница](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/Home_page.png)
Рисунок 1 – Главная страница

Выбор реализации решения в виде Web-приложения сделан по следующим причинам [6]:

* Доступность приложения с любых устройств с выходом в интернет и установленным браузером.
* Отсутствие  необходимости в дополнительной установке программного обеспечения.
* Высокая скорость разработки.

### Основной функционал приложения

#### Выбор шаблона видеоролика
На рисунке 2 представлен интерфейс пользователя при выборе шаблона видеоролика
![Выбор шаблона](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/templates.png)
Рисунок 2 - Выбор шаблона

На выбор пользователя представлены шаблоны видеороликов с возможностью предпросмотра. При выборе шаблона пользователь попадает на страницу редактирования.

#### Параметризация шаблона

Каждый шаблон состоит из набора последовательных фрагментов и общих настроек.
Общие настройки:
* Название
* Обложка книги с трех сторон
* Вид переплета
* Логотип
* Аудио сопровождение
* Фон (изображение или видео)

Пользовательский интерфейс представлен на рисунках 3 и 4.
![Общие настройки 1](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/custom1.png)
Рисунок 3 – Общие настройки видеоролика

![Общие настройки 2](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/custom2.png)
Рисунок 4 – Общие настройки видеоролика

 Для каждого фрагмента ролика так же настраиваются отдельно [4]:
* Текст в фрагменте
	* Шрифт
	* Цвет
* Изображения страниц

На рисунке 5 представлен интерфейс по индивидуальной настройке фрагмента ролика.
![Настройка фрагмента](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/custom3.png)
Рисунок 5 – Настройки для каждого фрагмента

#### Предпросмотр
При завершении редактирования фрагментов пользователю доступен для предпросмотра видеоролик, в котором используются все пользовательские настройки, текстуры, видео и аудио дорожки. Внешний вид представлен на рисунке 6.
![Предпросмотр](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/custom4.png)
Рисунок 6 – Предпросмотр

#### Страница заказа
На странице заказа отображается главная информация о ролике, информация о статусе рендеринга и его настройках (рис. 7).

![Информация о заказе](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/order.png)
Рисунок 7 – Информация о заказе

В личном кабинете пользователя доступны для просмотра, редактирования и скачивания все заказанные им ролики (рис. 8).

![История заказов](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/order_list.png)
Рисунок 8 – История заказов

### Архитектура программной реализации.

![Структура](https://github.com/moevm/scientific_writing-2017/blob/Komarov-D.N/2304/KomarovDN/image/struct.png)	
Рисунок 9 – Архитектура приложения

Решение реализовано как трехуровневое приложение (рис. 9), что помогает достичь цели, позволяющей использовать ядро веб-сайта для предоставления услуг / функциональности другим сайтам.

1. Уровень интерфейса (веб-сайт) реализует пользовательский интерфейс для клиентов. Он связывается с backend через и через API, предоставляемый приложением ASP.Net.

2. Уровень API, который реализует бизнес-логику и реализуется с использованием Microsoft ASP.Net и публикует REST API для интерфейсных приложений для всех функций.

3. Уровень «база данных» и «рендер ферма» состоит из трех компонентов:

	а. База данных веб-сайта (BTDB) для хранения информации о конкретном сайте, такой как пользовательская (клиентская) информация, сценарии и шаблоны трейлеров, конфигурации клиентских задач, информация о платежах и т. Д.
	
	б. Render - это пакет Microsoft Azure (комбинация узлов с выполняемыми на них задачами) с запущенным визуализатором Blender с параметрами, взятыми из задачи и базы данных (BTDB).  С обеспечением настройки пула узлов (компьютеров) для достижения оптимальной производительности с автоматическим расширением, когда это необходимо, и освобождением ресурсов, когда они больше не нужны.
	
	в. База исходных изображений / видео / аудио и видео файлов результатов (VideoDB), которая хранит загруженные файлы клиентом и видеофайлами и предоставляет их клиенту.

### Используемые технологи
Стек используемых технологий:
1. Microsoft ASP.Net и MVC Razor [7].
2. Microsoft Azure Cloud.
3. Microsoft SQL Server используется для размещения реляционной базы данных на основе SQL.
4. Microsoft Entity Framework Code First [7] технология использовалась для создания / изменения структуры базы данных и отношений между объектами базы данных для того, чтобы ускорить и упростить этап разработки баз данных. Данный подход позволяет команде разработчиков сосредоточиться на других аспектах веб-разработки, таких как усовершенствование дизайна пользовательского интерфейса, удобство использования и механизм предварительного просмотра видео.
5. Пользовательский компьютер выполняет рендеринг превью ролика в режиме реального времени с помощью WebGL [3], в частности Blend4Web.
6. RoslynT4 автогенерация когда на основе текстовых шаблонов для упрощения разработки [6].

## Исследование метода решения

Разработанное решение представляет собой веб-приложение с необходимым набором инструментов создания видеороликов, которые помогают сократить время ожидания перед просмотром превью ролика и предоставляет возможность внесения правок (замена текстур, аудио и т.д.) в реальном времени.
Представленное решение также имеет характеристики, описанные в разделе выбора решения:
* Интерфейс воплощает концепцию material design. Редактирование общих настроек ролика и каждого фрагмента находятся на соответствующих  вкладках. Все изменения отображаются в реальном времени в окне предпросмотра ролика. Для каждого шаблона ролика имеется возможность редактирования не только текстур, но и объектов внутри него по заданным свойствам. Доступ к приложению с возможностью редактирования осуществляется с любого компьютера пользователя с поддержкой WebGL [3], для скачивания результата можно использовать любое устройство с доступом в интернет.

* Быстрое получения превью ролика. Предпросмотр ролика доступен сразу после внесения изменений в шаблон.

* Высокая скорость получения конечного результата. Рендеринг осуществляется в облачном сервисе на пуле компьютеров для достижения оптимальной производительности с автоматическим расширением, когда это необходимо, и освобождением ресурсов, когда они больше не нужны.

### Сравнение результата с аналогами
Для сравнение результатов с аналогами используются критерии, приведенные в разделе “Обзор предметной области”. Результаты приведены в таблице 2.
Таблица 2 -  сравнения по критериям

Критерий\Аналог | Дизайнер | Презентация| Самостоятельно | Решение 
------------ | ------------- | ------------- |------------- |------------- 
Соответствие ТЗ |+| -|+ | +
Стоимость | Высокая | Низкая/Бесплатно |Бесплатно | Низкая
Скорость | Высокая | Низкая | Очень низкая | Высокая
Удобство | Среднее | Среднее | Среднее | Высокое

## Заключение

Целью исследования было — сокращение времени ожидания рендеринга перед просмотром превью ролика и разработка программного решения, которое требовало минимальных затрат времени пользователя с возможностью внесения изменений в текстуры, аудио и видео сопровождение.
В процессе исследования был проведен обзор методов создания 3D, проведен анализ необходимого функционала программного решения, реализовано приложение, позволяющее создавать видеоролики по шаблонам.
Недостатками решения является ограниченный набор шаблонов на начальном этапе и ограниченность вариантов роликов шаблонами. Достоинством является простота создания роликов, предпросмотр результата в «реальном времени».
Дальнейшими направлениями развития полученного решения является исследование конфигураций пула компьютеров, на котором происходит конечный рендеринг видеороликов, и выбор оптимальных конфигураций, соответствующих требуемым задачам с учетом стоимости и скорости рендеринга.


## Список литературы
1.	Jakob Nielsen Designing Web Usability: The Practice of Simplicity. New Riders Publishing Thousand Oaks, CA, USA, 1999. 419с.
2.	Aldo Gangemi Ontology Design Patterns for Semantic Web Content, Laboratory for Applied OntologyISTC-CNR, Rome, Italy, 2005. 3729с.
3.	Edward Angel, Dave Shreiner Interactive Computer Graphics with WebGL, Addison-Wesley Professional, 2014. 736с.
4.	Айзек В. Керлоу Искусство 3D- анимации и спецэффектов, M: Вершина, 2004. 480с.
5.	Nick Harrison Code Generation with Roslyn, Apress, Berkeley, CA, 2017. 420с.
6.	Huang, Yun, Dobreski, Brian Applying motivational design to support informal learning of universal design for web applications, iSchools,2017. 9с.
7.	Design and application of lighting energy consumption monitoring platform based on MVC and entity framework, Zhongming Xie, Huabing He, Yunfei Li, Juncheng Jia, IEEE, 2014
