## Описание метода решения
При решении необходимо обрабатывать не аналоговый, а дискретный сигнал, поэтому первым этапом является выбор частоты дискретизации таким образом, чтобы можно было восстановить исходный аналоговый сигнал без потерь. Для аудиозаписей обычно используется частота 44,1 кГц, так как человек может слышать звуки в диапазоне 20 - 20000 Гц, а по теореме Котельникова частота дискретизации частота дискретизации должна быть в два раза или более превышать верхнюю полезную частоту для корректного восстановления исходного сигнала.

Затем вычисляется дискретное прямое преобразование Фурье для получения аналогового и фазового спектра сигналов, что позволяет разложить суммарный сигнал, воспринимаемый ухом, на исходные синусоиды, создаваемые музыкальными инструментами, вокалом и т. п. В связи с невозможностью исследовать сигнал на бесконечном промежутке (ограниченность мелодий по длительности) оптимальным решением является вычисление оконного преобразования Фурье (STFT - Short-Time Fourier Transform) по формуле (1), где оконная функция *w[n-m]* и является ограничителем интервала анализа [1]. 

![equation](http://latex.codecogs.com/gif.latex?F%28m%2C%20%5Comega%20%29%20%3D%20%5Csum_%7Bn%3D-%20%5Cinfty%7D%5E%7B&plus;%5Cinfty%7D%20%7Bf%5Bn%5D%20w%5Bn%20-%20m%5D%20e%5E%7B-j%20%5Comega%20n%7D%20%7D)

В качестве оконной функции выбрано окно Ханна (Хеннинга), так как оно позволяет снизить максимальный уровень боковых лепестков частотной характеристики по сравнению с максимальным уровнем боковых лепестков при использовании прямоугольного окна. Кроме того, оконное преобразование Фурье можно вычислять на основе расчета быстрого преобразования Фурье, что позволяет увеличить скорость вычислений. При этом для применения быстрого преобразования Фурье ширина выбранного окна должна быть кратна степени двойки, в данной работе выбрана ширина окна в 4096 отсчетов.

После вычисления оконного преобразования Фурье необходимо на основе полученного амплитудного спектра рассчитать искомые музыкальные характеристики. Для решения поставленных задач принято решение использовать метод главных компонент (PCA - Principal Component Analysis). Данный метод позволяет уменьшить размерность данных и при этом потерять наименьшее количество информации [3, с. 354], то есть будут выделены главные признаки (музыкальные характеристики), которые больше всего характеризуют амплитудный спектр и, соответственно, всю мелодию. Основной проблемой в применении метода главных компонент является то, что данные должны иметь одинаковую размерность, то есть, применительно к музыке, длительность всех композиций должна быть одинаковой. Для решения этой проблемы принято решение анализировать не всю мелодию, а отдельные сегменты мелодий по 10 секунд. Помимо одинаковой размерности данных такое решение также позволит более точно анализировать музыку, являющуюся миксом - последовательностью из нескольких музыкальных произведений, сведенных в одно произведение. Другой проблемой применения метода главных компонент к данной задаче является большая размерность данных: при частоте дискретизации в 44,1 кГц количество отсчетов в 10 анализируемых секундах произведения будет равно 441000 отсчетам, и это количество отсчетов надо посчитать для всех воспринимаемых человеком частот от 20 Гц до 20 кГц. Такой большой набор анализируемых признаков не только требует большого количества времени и ресурсов на расчет, но также и наличия большой базы данных для устранения проблемы малой выборки [2]. Для решения проблемы большой размерности данных 10-секундная музыкальная композиция разбивается на сегменты по 250 мс, и получается, таким образом, 80 сегментов, аналогично разбивается диапазон частот на 80 сегментов и в итоге получается 6400 секторов, включающих некоторый диапазон частот в определенный промежуток времени. Далее в каждом таком секторе можно произвести усреднение по амплитуде и получить 6400 значений амплитуд, которые и будут являться признаками амплитудного спектра. Такое разбиение можно сделать в связи с тем, что каждое нажатие на клавишу пианино, удар по струне гитары и другие действия будут создавать не короткий звук, а звук имеющий некоторую длительность (возможность разбиения по временной шкале); также разные музыкальные инструменты и вокал звучат в разных диапазонах частот, что позволяет производить разбиение на полосы частот.

При использовании метода главных компонент имеется обучающая база данных музыкальных композиций *X*, производится стандартизация данной матрицы, а затем вычисляется ее матрица ковариаций *R*. Матрица *A*, столбцы которой являются собственными векторами матрицы *R*, содержит линейные коэффициенты для главных компонент. Количество главных компонент выбирается таким образом, чтобы их дисперсия составляла 90% от дисперсии исходных данных, что позволит существенно сократить количество главных компонент и при этом минимизировать потерю информации. Для расчета значений главных компонент искомой мелодии Y применяется формула (2)

![equation](http://latex.codecogs.com/gif.latex?F%20%3D%20Y%20A%20%5CLambda%5E%7B-1/2%7D)

 где *F* - рассчитываемые значения главных компонент, ![equation](http://latex.codecogs.com/gif.latex?\Lambda) - диагональная матрица собственных чисел матрицы ковариаций *R*.

## Источники
1. Alfred   Mertins,   “Signal   Analysis:   Wavelets,   Filter   Bank,   Time   Frequency,   Transform   and Application”, Chapter 6, pp. 144-145, copyright © 1999, John wiley and Sons Ltd, Print ISBN 0471-98626-7 Electronic ISBN 0-470-84183-4. 
2. Mundfrom, D.J., Shaw, D.G., & Ke, T.L. (2005). Minimum sample size recommendations for conducting factor analyses. International Journal of Testing, 5 (2), 159-168.
3. А.Афифи, С.Эйзен. Статистический анализ. Подход с использованием ЭВМ. М.-Мир, 1982. 